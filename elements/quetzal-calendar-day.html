<!--
A single day in a calendar 
-->

<link rel="import" href="quetzal-element.html">

<polymer-element name="quetzal-calendar-day" extends="quetzal-element" attributes="date" constructor="QuetzalCalendarDay">

<template>

<div id="date"></div>

</template>

<script>
Polymer( "quetzal-calendar-day", {

  // TODO: publish() date and accept both Date objects and date strings.
  dateChanged: function() {
    this.$.date.textContent = this.date.getDate();
  }

});

//
// Static helpers
//

QuetzalCalendarDay.MILLISECONDS_IN_DAY = 24 * 60 * 60 * 1000;

QuetzalCalendarDay.midnightOnDate = function( date ) {
  var d = new Date( date.getTime() );
  d.setHours(0);
  d.setMinutes(0);
  d.setSeconds(0);
  d.setMilliseconds(0);
  return d;
};

// Return the result of adding/subtracting a number of days to a date.
QuetzalCalendarDay.offsetDateByDays = function( date, days ) {
  // Use noon hour for date math, since adding/subtracting multiples of 24 hours
  // starting from noon is guaranteed to end up on the correct date (although
  // the hours might have changed).
  var noon = new Date( date.getTime() );
  noon.setHours( 11 );
  var result = new Date( noon.getTime() + ( days * this.MILLISECONDS_IN_DAY ));
  // Restore original hours
  result.setHours( date.getHours() );
  return result;
};

// Returns midnight today.
QuetzalCalendarDay.today = function() {
  return QuetzalCalendarDay.midnightOnDate( new Date() );
};

</script>

</polymer-element>
