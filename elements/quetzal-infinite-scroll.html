<polymer-element name="quetzal-infinite-scroll">

<template>
  <style>
  :host {
    display: block;
    overflow-y: auto;
  }
  </style>
  <content id="itemTemplate">
    <div></div>
  </content>
</template>

<script>
Polymer( "quetzal-infinite-scroll", {

  addedElements: function() {
    // Subclasses can override to set up new elements.
  },

  addElementToBottom: function() {
    var copied = this.$.itemTemplate.cloneNode( true );
    var children = copied.children.array();
    this.addedElements( children );
    children.forEach( function( child ) {
      this.shadowRoot.appendChild( child );    
    }.bind( this ));
  },

  addPageToBottom: function() {
    for ( var i = 0; i < 25; i++ ) {
      this.addElementToBottom();
    }
  },

  ready: function() {
    this.addEventListener( "scroll", function() {
      this.scrolled();
    }.bind( this ));
    this.addPageToBottom();
  },

  scrolled: function() {
    var scrollBottom = this.scrollTop + this.clientHeight;
    var belowView = this.scrollHeight - scrollBottom;
    if ( belowView < this.clientHeight ) {
      this.addPageToBottom();
    }
  }

});
</script>

</polymer-element>
