<!DOCTYPE html>
<html>
<head>

<meta charset="utf-8">

<style>
body,
button,
input {
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 15px;
}

body {
    margin: 0.5in;
}
</style>

<script>
function a( element ) {
    var root = element.webkitCreateShadowRoot();
    root.innerHTML = "<span>A<content></content>A</span>";
    root.applyAuthorStyles = true;
}

function b( element ) {
    a( element );
    var root = element.webkitCreateShadowRoot();
    root.innerHTML = "<shadow></shadow><span>B<content></content>B</span>";
    root.applyAuthorStyles = true;
    // var wrapper = root.childNodes[0];
    // a( wrapper );
}

function c( element ) {
    var root = element.webkitCreateShadowRoot();
    root.innerHTML = "<span>C<content></content>C</span>";
    root.applyAuthorStyles = true;
    var wrapper = root.childNodes[0];
    b( wrapper );
}

function createComponents() {
    var elements = document.querySelectorAll( "[is]" );
    Array.prototype.forEach.call( elements, function( element ) {
        className = element.attributes.is.nodeValue;
        elementClass = window[ className ];
        new elementClass( element );
    });
}

window.addEventListener( "load", function() {
    createComponents();
});
</script>

</head>

<body>
    <div is="a">a</div>
    <div is="b">b</div>
    <div is="c">c</div>
</body>

</html>
